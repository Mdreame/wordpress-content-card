(()=>{"use strict";const e=window.wp.blocks,t=window.wp.blockEditor,s=window.wp.components,a=window.wp.i18n,l=JSON.parse('{"UU":"content-card/content-card"}'),i=window.ReactJSXRuntime,n=e=>10*e+"%";(0,e.registerBlockType)(l.UU,{edit:({attributes:e,setAttributes:l})=>{const{imageUrl:r,titleText:c,ratingScore:o,abstractText:d,titleLink:x}=e,p=(0,t.useBlockProps)();return(0,i.jsxs)("div",{...p,children:[(0,i.jsx)(t.InspectorControls,{children:(0,i.jsxs)(s.PanelBody,{title:(0,a.__)("卡片内容设置 (侧栏)","content-card"),children:[(0,i.jsx)(s.RangeControl,{label:(0,a.__)("评分 (0-10)","content-card"),value:o,onChange:e=>l({ratingScore:e}),min:0,max:10,step:.1}),(0,i.jsx)(s.URLInput,{label:(0,a.__)("标题链接","content-card"),value:x,onChange:e=>l({titleLink:e})}),(0,i.jsx)(s.TextControl,{label:(0,a.__)("外部图片 URL","content-card"),value:r,onChange:e=>l({imageUrl:e}),help:(0,a.__)("可以直接输入外部图片链接，或使用下方媒体库按钮。","content-card")})]})}),(0,i.jsx)("div",{className:"doulist-item",children:(0,i.jsxs)("div",{className:"doulist-subject",children:[(0,i.jsx)("div",{className:"doulist-post",children:(0,i.jsx)(t.MediaUploadCheck,{children:(0,i.jsx)(t.MediaUpload,{onSelect:e=>{l({imageUrl:e.url})},allowedTypes:["image"],value:r,render:({open:e})=>(0,i.jsxs)("div",{className:"content-card-image-wrapper",style:{width:"96px",height:"96px",position:"relative"},children:[r?(0,i.jsx)("img",{src:r,alt:c||"内容卡片图片"}):(0,i.jsx)("div",{onClick:e,style:{width:"96px",height:"96px",backgroundColor:"#ccc",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",cursor:"pointer"},children:(0,a.__)("添加图片","content-card")}),r&&(0,i.jsx)(s.Button,{isDestructive:!0,onClick:()=>l({imageUrl:""}),style:{position:"absolute",top:0,right:0,zIndex:10},children:"X"})]})})})}),(0,i.jsxs)("div",{className:"doulist-content",children:[(0,i.jsx)(s.TextControl,{value:c,onChange:e=>l({titleText:e}),placeholder:(0,a.__)("在此处输入标题","content-card"),className:"doulist-title-input",label:(0,a.__)("标题","content-card")}),(0,i.jsxs)("div",{className:"rating",children:[(0,i.jsx)("span",{className:"allstardark",children:(0,i.jsx)("span",{className:"allstarlight",style:{width:n(o)}})}),(0,i.jsx)(s.TextControl,{value:o,onChange:e=>{l({ratingScore:""===e?0:parseFloat(e)})},type:"number",min:"0",max:"10",step:"0.1",placeholder:"4.0",className:"rating-input",style:{width:"50px",marginLeft:"5px",display:"inline-block"}})]}),(0,i.jsx)(t.RichText,{tagName:"div",className:"abstract",value:d,onChange:e=>l({abstractText:e}),placeholder:(0,a.__)("在此处输入描述/摘要","content-card")})]})]})})]})},save:({attributes:e})=>{const{imageUrl:s,titleText:a,ratingScore:l,abstractText:r,titleLink:c}=e,o=t.useBlockProps.save(),d=n(l);return s?(0,i.jsx)("figure",{...o,className:"wp-block-embed is-type-rich",children:(0,i.jsx)("div",{className:"wp-block-embed__wrapper",children:(0,i.jsx)("div",{className:"doulist-item",children:(0,i.jsxs)("div",{className:"doulist-subject",children:[(0,i.jsx)("div",{className:"doulist-post",children:(0,i.jsx)("img",{decoding:"async",referrerpolicy:"no-referrer",src:s,alt:a||"内容卡片图片"})}),(0,i.jsxs)("div",{className:"doulist-content",children:[(0,i.jsx)("div",{className:"doulist-title",children:(0,i.jsx)("a",{href:c,className:"cute",target:"_blank",rel:"external nofollow",children:` ✒️${a} `})}),(0,i.jsxs)("div",{className:"rating",children:[(0,i.jsx)("span",{className:"allstardark",children:(0,i.jsx)("span",{className:"allstarlight",style:{width:d}})}),(0,i.jsx)("span",{className:"rating_nums",children:` ✒️${l} `})]}),(0,i.jsx)(t.RichText.Content,{tagName:"div",className:"abstract",value:` ✒️ ${r} `})]})]})})})}):null}})})();
